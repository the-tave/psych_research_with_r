<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Association Statistics | Psychological Research with R</title>
  <meta name="description" content="<p>This is an online introduction to R targetted especially at psychologists.
It should guide the reader through the first challenges in working with R
and provide the tools and skills to write a whole report with data analysis and visualization
directly in R and R Markdown.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Association Statistics | Psychological Research with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is an online introduction to R targetted especially at psychologists.
It should guide the reader through the first challenges in working with R
and provide the tools and skills to write a whole report with data analysis and visualization
directly in R and R Markdown.</p>" />
  <meta name="github-repo" content="the-tave/psych_research_with_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Association Statistics | Psychological Research with R" />
  
  <meta name="twitter:description" content="<p>This is an online introduction to R targetted especially at psychologists.
It should guide the reader through the first challenges in working with R
and provide the tools and skills to write a whole report with data analysis and visualization
directly in R and R Markdown.</p>" />
  

<meta name="author" content="Anni Tave Overlander" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="difference-statistics.html"/>
<link rel="next" href="r-markdown.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="www/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li>
<a href="./"><i class="fa-solid fa-mug-hot" style="color: #a34c21;"></i> Psychological Research with R 
<i class="fa-solid fa-mug-hot" style="color: #a34c21;"></i></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about..."><i class="fa fa-check"></i>About...</a></li>
</ul></li>
<li class="part"><span><b>I First Steps</b></span></li>
<li class="chapter" data-level="1" data-path="intro-and-installation.html"><a href="intro-and-installation.html"><i class="fa fa-check"></i><b>1</b> Intro and Installation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-and-installation.html"><a href="intro-and-installation.html#what-is-r-what-is-r-studio"><i class="fa fa-check"></i><b>1.1</b> What is R? What is R Studio?</a></li>
<li class="chapter" data-level="1.2" data-path="intro-and-installation.html"><a href="intro-and-installation.html#installing-r-and-r-studio"><i class="fa fa-check"></i><b>1.2</b> Installing R and R Studio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro-and-installation.html"><a href="intro-and-installation.html#workflow"><i class="fa fa-check"></i><b>1.2.1</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro-and-installation.html"><a href="intro-and-installation.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing Packages</a>
<ul>
<li class="chapter" data-level="" data-path="intro-and-installation.html"><a href="intro-and-installation.html#posit-cloud"><i class="fa fa-check"></i>Posit Cloud</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro-and-installation.html"><a href="intro-and-installation.html#wrap-up-further-resources"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> R Basics &amp; Error Messages</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#basics-1"><i class="fa fa-check"></i><b>2.1</b> Basics</a>
<ul>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#basic-functions"><i class="fa fa-check"></i>Basic Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basics.html"><a href="basics.html#logic"><i class="fa fa-check"></i><b>2.2</b> Logic</a></li>
<li class="chapter" data-level="2.3" data-path="basics.html"><a href="basics.html#reading-error-messages"><i class="fa fa-check"></i><b>2.3</b> Reading Error Messages</a>
<ul>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#error-unexpected-x-in-y"><i class="fa fa-check"></i><em>Error: unexpected 'X' in "Y"</em></a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#error-object-a-not-found"><i class="fa fa-check"></i><em>Error: object 'A' not found</em></a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#error-r-does-nothing-after-running-a-command"><i class="fa fa-check"></i><em>Error</em>: R does nothing after running a command</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#pipe1"><i class="fa fa-check"></i>The pipe operator <code>|&gt;</code> or <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#wrap-up-further-resources-1"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="best-practice.html"><a href="best-practice.html"><i class="fa fa-check"></i><b>3</b> Best Practice</a>
<ul>
<li class="chapter" data-level="3.1" data-path="best-practice.html"><a href="best-practice.html#varnames"><i class="fa fa-check"></i><b>3.1</b> Naming Conventions</a></li>
<li class="chapter" data-level="3.2" data-path="best-practice.html"><a href="best-practice.html#exercise-creating-data"><i class="fa fa-check"></i><b>3.2</b> Exercise: Creating Data</a></li>
<li class="chapter" data-level="3.3" data-path="best-practice.html"><a href="best-practice.html#working-directories"><i class="fa fa-check"></i><b>3.3</b> Working Directories</a></li>
<li class="chapter" data-level="3.4" data-path="best-practice.html"><a href="best-practice.html#r-projects-r-project"><i class="fa fa-check"></i><b>3.4</b> R Projects <img src="img/rproj.png" height="30" alt="R Project" /></a>
<ul>
<li class="chapter" data-level="" data-path="best-practice.html"><a href="best-practice.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="best-practice.html"><a href="best-practice.html#make-r-your-own"><i class="fa fa-check"></i><b>3.5</b> Make R your own</a></li>
<li class="chapter" data-level="" data-path="best-practice.html"><a href="best-practice.html#wrap-up-further-resources-2"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
<li class="chapter" data-level="" data-path="best-practice.html"><a href="best-practice.html#working-with-version-control"><i class="fa fa-check"></i>Working with Version Control</a></li>
</ul></li>
<li class="part"><span><b>II Into the <code>tidyverse</code></b></span></li>
<li class="chapter" data-level="4" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>4</b> Data munging with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="dplyr.html"><a href="dplyr.html#working-with-packages"><i class="fa fa-check"></i><b>4.1</b> Working with packages</a></li>
<li class="chapter" data-level="4.2" data-path="dplyr.html"><a href="dplyr.html#the-tidyverse"><i class="fa fa-check"></i><b>4.2</b> The tidyverse</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="dplyr.html"><a href="dplyr.html#what-is-dplyr-dplyr-logo"><i class="fa fa-check"></i><b>4.2.1</b> What is <code>dplyr</code>? <img src="img/dplyr.png" height="80" alt="dplyr logo" /></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dplyr.html"><a href="dplyr.html#intro-iris"><i class="fa fa-check"></i><b>4.3</b> Intro to <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#imagine..."><i class="fa fa-check"></i>Imagine...</a></li>
<li class="chapter" data-level="4.3.1" data-path="dplyr.html"><a href="dplyr.html#filter"><i class="fa fa-check"></i><b>4.3.1</b> Filter</a></li>
<li class="chapter" data-level="4.3.2" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>4.3.2</b> Select</a></li>
<li class="chapter" data-level="4.3.3" data-path="dplyr.html"><a href="dplyr.html#rename"><i class="fa fa-check"></i><b>4.3.3</b> Rename</a></li>
<li class="chapter" data-level="4.3.4" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>4.3.4</b> Mutate</a></li>
<li class="chapter" data-level="4.3.5" data-path="dplyr.html"><a href="dplyr.html#group_by-summarize"><i class="fa fa-check"></i><b>4.3.5</b> group_by &amp; summarize</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#data-munging"><i class="fa fa-check"></i>Data Munging</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#group-statistics"><i class="fa fa-check"></i>Group Statistics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#piping-hot"><i class="fa fa-check"></i>Piping Hot %&gt;%</a></li>
<li class="chapter" data-level="" data-path="dplyr.html"><a href="dplyr.html#wrapupdplyr"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>5</b> Pretty plots with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot2.html"><a href="ggplot2.html#data-visalization"><i class="fa fa-check"></i><b>5.1</b> Data Visalization <i class="fa-solid fa-chart-line" style="color: darkred;"></i></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ggplot2.html"><a href="ggplot2.html#example-sine-cosine"><i class="fa fa-check"></i><b>5.1.1</b> Example: Sine &amp; Cosine</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ggplot2.html"><a href="ggplot2.html#what-is-ggplot2"><i class="fa fa-check"></i><b>5.2</b> What is <code>ggplot2</code>?</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#ggplot"><i class="fa fa-check"></i><code>ggplot()</code></a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#geom_xyz"><i class="fa fa-check"></i><code>geom_XYZ()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ggplot2.html"><a href="ggplot2.html#your-first-bar-plot"><i class="fa fa-check"></i><b>5.3</b> Your First Bar Plot</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ggplot2.html"><a href="ggplot2.html#making-plots-prettier"><i class="fa fa-check"></i><b>5.3.1</b> Making Plots Prettier</a></li>
<li class="chapter" data-level="5.3.2" data-path="ggplot2.html"><a href="ggplot2.html#example-bar-plot-with-color-and-fill"><i class="fa fa-check"></i><b>5.3.2</b> Example: Bar Plot with color and fill</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot2.html"><a href="ggplot2.html#static-vs.-dynamic-aesthetics"><i class="fa fa-check"></i><b>5.4</b> Static vs. Dynamic Aesthetics</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="ggplot2.html"><a href="ggplot2.html#exercise-1"><i class="fa fa-check"></i><b>5.4.1</b> Exercise</a></li>
<li class="chapter" data-level="5.4.2" data-path="ggplot2.html"><a href="ggplot2.html#solution"><i class="fa fa-check"></i><b>5.4.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ggplot2.html"><a href="ggplot2.html#adding-labels-and-themes"><i class="fa fa-check"></i><b>5.5</b> Adding labels and themes</a></li>
<li class="chapter" data-level="5.6" data-path="ggplot2.html"><a href="ggplot2.html#bivariate-visualizations"><i class="fa fa-check"></i><b>5.6</b> Bivariate Visualizations</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ggplot2.html"><a href="ggplot2.html#boxplot-example"><i class="fa fa-check"></i><b>5.6.1</b> Boxplot Example</a></li>
<li class="chapter" data-level="5.6.2" data-path="ggplot2.html"><a href="ggplot2.html#exercise-boxplot"><i class="fa fa-check"></i><b>5.6.2</b> Exercise: Boxplot</a></li>
<li class="chapter" data-level="5.6.3" data-path="ggplot2.html"><a href="ggplot2.html#inspiration-colors-and-palettes"><i class="fa fa-check"></i><b>5.6.3</b> Inspiration: colors and palettes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#wrap-up-further-resources-3"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="part"><span><b>III The Nitty-Gritty</b></span></li>
<li class="chapter" data-level="6" data-path="exdata.html"><a href="exdata.html"><i class="fa fa-check"></i><b>6</b> Working with existing Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="exdata.html"><a href="exdata.html#different-types-of-data-sources"><i class="fa fa-check"></i><b>6.1</b> Different types of data sources</a></li>
<li class="chapter" data-level="6.2" data-path="exdata.html"><a href="exdata.html#reading-in-the-data"><i class="fa fa-check"></i><b>6.2</b> Reading in the data</a>
<ul>
<li class="chapter" data-level="" data-path="exdata.html"><a href="exdata.html#generated-code"><i class="fa fa-check"></i>Generated Code</a></li>
<li class="chapter" data-level="" data-path="exdata.html"><a href="exdata.html#basic-edits"><i class="fa fa-check"></i>Basic Edits <i class="fa-solid fa-paintbrush" style="color: darkgreen;"></i></a></li>
<li class="chapter" data-level="" data-path="exdata.html"><a href="exdata.html#result"><i class="fa fa-check"></i>Result</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="exdata.html"><a href="exdata.html#codebook"><i class="fa fa-check"></i><b>6.3</b> Codebook</a></li>
<li class="chapter" data-level="6.4" data-path="exdata.html"><a href="exdata.html#descriptives"><i class="fa fa-check"></i><b>6.4</b> Descriptives</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="exdata.html"><a href="exdata.html#group_by-summarize-1"><i class="fa fa-check"></i><b>6.4.1</b> group_by &amp; summarize</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="exdata.html"><a href="exdata.html#missing-data"><i class="fa fa-check"></i><b>6.5</b> Missing Data</a></li>
<li class="chapter" data-level="" data-path="exdata.html"><a href="exdata.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="exdata.html"><a href="exdata.html#group_by-summarize-2"><i class="fa fa-check"></i>group_by &amp; summarize</a></li>
<li class="chapter" data-level="" data-path="exdata.html"><a href="exdata.html#prepare-seminar-data"><i class="fa fa-check"></i>Prepare seminar data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exdata.html"><a href="exdata.html#wrap-up-further-resources-4"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html"><i class="fa fa-check"></i><b>7</b> Loops and Conditionals</a>
<ul>
<li class="chapter" data-level="7.1" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#what-is-a-loop"><i class="fa fa-check"></i><b>7.1</b> What is a loop?</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#what-are-conditionals"><i class="fa fa-check"></i><b>7.1.1</b> What are conditionals?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#exercise-what-should-i-use"><i class="fa fa-check"></i><b>7.2</b> Exercise: What should I use?</a></li>
<li class="chapter" data-level="7.3" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#for-loop"><i class="fa fa-check"></i><b>7.3</b> for-loop</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#example"><i class="fa fa-check"></i><b>7.3.1</b> Example</a></li>
<li class="chapter" data-level="7.3.2" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#conditionals-if---else"><i class="fa fa-check"></i><b>7.3.2</b> Conditionals: If - else</a></li>
<li class="chapter" data-level="7.3.3" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#conditionals-if---else-1"><i class="fa fa-check"></i><b>7.3.3</b> Conditionals: If - else</a></li>
<li class="chapter" data-level="7.3.4" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#exercise-2"><i class="fa fa-check"></i><b>7.3.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#same-function-different-variables"><i class="fa fa-check"></i><b>7.4</b> Same function, different variables</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#more-sophisticated"><i class="fa fa-check"></i><b>7.4.1</b> More sophisticated</a></li>
<li class="chapter" data-level="7.4.2" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#with-saving-values"><i class="fa fa-check"></i><b>7.4.2</b> With saving values</a></li>
<li class="chapter" data-level="7.4.3" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#exercise-seminar-data"><i class="fa fa-check"></i><b>7.4.3</b> Exercise: Seminar Data</a></li>
<li class="chapter" data-level="7.4.4" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#solution-1"><i class="fa fa-check"></i><b>7.4.4</b> Solution</a></li>
<li class="chapter" data-level="7.4.5" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#checking-whats-going-on"><i class="fa fa-check"></i><b>7.4.5</b> Checking What's Going On</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#loop-with-conditional"><i class="fa fa-check"></i><b>7.5</b> Loop with Conditional</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#elements"><i class="fa fa-check"></i><b>7.5.1</b> Elements</a></li>
<li class="chapter" data-level="7.5.2" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#and-a-more-complicated-outlook..."><i class="fa fa-check"></i><b>7.5.2</b> And a more complicated outlook...</a></li>
<li class="chapter" data-level="7.5.3" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#result-1"><i class="fa fa-check"></i><b>7.5.3</b> Result</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="loops-and-conditionals.html"><a href="loops-and-conditionals.html#wrap-up-further-resources-5"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="difference-statistics.html"><a href="difference-statistics.html"><i class="fa fa-check"></i><b>8</b> Difference Statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="difference-statistics.html"><a href="difference-statistics.html#statistics-re-cap"><i class="fa fa-check"></i><b>8.1</b> Statistics Re-cap <i class="fa-solid fa-graduation-cap" style="color: darkred;"></i></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="difference-statistics.html"><a href="difference-statistics.html#pre-requisites"><i class="fa fa-check"></i><b>8.1.1</b> Pre-Requisites</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="difference-statistics.html"><a href="difference-statistics.html#chi2"><i class="fa fa-check"></i><b>8.2</b> <span class="math inline">\(\chi^2\)</span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="difference-statistics.html"><a href="difference-statistics.html#calculation"><i class="fa fa-check"></i><b>8.2.1</b> Calculation:</a></li>
<li class="chapter" data-level="8.2.2" data-path="difference-statistics.html"><a href="difference-statistics.html#how-to-in-r"><i class="fa fa-check"></i><b>8.2.2</b> How to in R</a></li>
<li class="chapter" data-level="8.2.3" data-path="difference-statistics.html"><a href="difference-statistics.html#exercise-3"><i class="fa fa-check"></i><b>8.2.3</b> Exercise <i class="fa-solid fa-ghost" style="color: #dcdcdc;"></i> <i class="fa-solid fa-music"></i></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="difference-statistics.html"><a href="difference-statistics.html#t-test"><i class="fa fa-check"></i><b>8.3</b> t-Test</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="difference-statistics.html"><a href="difference-statistics.html#test-statistic-t"><i class="fa fa-check"></i><b>8.3.1</b> Test statistic <em>t</em></a></li>
<li class="chapter" data-level="8.3.2" data-path="difference-statistics.html"><a href="difference-statistics.html#test-statistic-t-1"><i class="fa fa-check"></i><b>8.3.2</b> Test statistic <em>t</em></a></li>
<li class="chapter" data-level="8.3.3" data-path="difference-statistics.html"><a href="difference-statistics.html#how-to-in-r-1"><i class="fa fa-check"></i><b>8.3.3</b> How to in R</a></li>
<li class="chapter" data-level="8.3.4" data-path="difference-statistics.html"><a href="difference-statistics.html#examples"><i class="fa fa-check"></i><b>8.3.4</b> Examples</a></li>
<li class="chapter" data-level="8.3.5" data-path="difference-statistics.html"><a href="difference-statistics.html#exercise-4"><i class="fa fa-check"></i><b>8.3.5</b> Exercise <i class="fa-solid fa-computer"></i></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="difference-statistics.html"><a href="difference-statistics.html#anova"><i class="fa fa-check"></i><b>8.4</b> ANOVA</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="difference-statistics.html"><a href="difference-statistics.html#how-to---theoretically"><i class="fa fa-check"></i><b>8.4.1</b> How to - theoretically</a></li>
<li class="chapter" data-level="" data-path="difference-statistics.html"><a href="difference-statistics.html#example-music-genre-and-loudness"><i class="fa fa-check"></i>Example: Music genre and loudness <i class="fa-solid fa-music"></i></a></li>
<li class="chapter" data-level="8.4.2" data-path="difference-statistics.html"><a href="difference-statistics.html#addendum-for-demonstration-only-bootstrapped-data-for-larger-sample-size"><i class="fa fa-check"></i><b>8.4.2</b> Addendum for demonstration only: Bootstrapped Data for larger sample size</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="difference-statistics.html"><a href="difference-statistics.html#reporting-with-the-apa-papaja-packages"><i class="fa fa-check"></i><b>8.5</b> Reporting with the <code>apa</code> &amp; <code>papaja</code> packages</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="difference-statistics.html"><a href="difference-statistics.html#usage"><i class="fa fa-check"></i><b>8.5.1</b> Usage</a></li>
<li class="chapter" data-level="8.5.2" data-path="difference-statistics.html"><a href="difference-statistics.html#usage-in-r-markdown"><i class="fa fa-check"></i><b>8.5.2</b> Usage in R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="difference-statistics.html"><a href="difference-statistics.html#wrap-up-further-resources-6"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="association-statistics.html"><a href="association-statistics.html"><i class="fa fa-check"></i><b>9</b> Association Statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="association-statistics.html"><a href="association-statistics.html#correlation"><i class="fa fa-check"></i><b>9.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="association-statistics.html"><a href="association-statistics.html#guess-the-correlation"><i class="fa fa-check"></i><b>9.1.1</b> Guess the correlation!</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="association-statistics.html"><a href="association-statistics.html#correlation-in-r"><i class="fa fa-check"></i><b>9.2</b> Correlation in R</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="association-statistics.html"><a href="association-statistics.html#handling-missing-data"><i class="fa fa-check"></i><b>9.2.1</b> Handling missing data</a></li>
<li class="chapter" data-level="9.2.2" data-path="association-statistics.html"><a href="association-statistics.html#exercise-5"><i class="fa fa-check"></i><b>9.2.2</b> Exercise</a></li>
<li class="chapter" data-level="9.2.3" data-path="association-statistics.html"><a href="association-statistics.html#quiz"><i class="fa fa-check"></i><b>9.2.3</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="association-statistics.html"><a href="association-statistics.html#linear-regression"><i class="fa fa-check"></i><b>9.3</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="association-statistics.html"><a href="association-statistics.html#build-the-model"><i class="fa fa-check"></i><b>9.3.1</b> Build the model</a></li>
<li class="chapter" data-level="9.3.2" data-path="association-statistics.html"><a href="association-statistics.html#visual-inspection"><i class="fa fa-check"></i><b>9.3.2</b> Visual Inspection</a></li>
<li class="chapter" data-level="9.3.3" data-path="association-statistics.html"><a href="association-statistics.html#build-the-model-1"><i class="fa fa-check"></i><b>9.3.3</b> Build the model</a></li>
<li class="chapter" data-level="9.3.4" data-path="association-statistics.html"><a href="association-statistics.html#analyze-the-model"><i class="fa fa-check"></i><b>9.3.4</b> Analyze the model</a></li>
<li class="chapter" data-level="9.3.5" data-path="association-statistics.html"><a href="association-statistics.html#exercise-6"><i class="fa fa-check"></i><b>9.3.5</b> Exercise <i class="fa-regular fa-hourglass-half"  style="color: #dcdcdc;"></i> <i class="fa-solid fa-laptop-code"  style="color: #dcdcdc;"></i></a></li>
<li class="chapter" data-level="9.3.6" data-path="association-statistics.html"><a href="association-statistics.html#a-word-to-the-wise"><i class="fa fa-check"></i><b>9.3.6</b> A word to the wise</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="association-statistics.html"><a href="association-statistics.html#anova-exercise"><i class="fa fa-check"></i><b>9.4</b> ANOVA Exercise</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="association-statistics.html"><a href="association-statistics.html#exercise-7"><i class="fa fa-check"></i><b>9.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="association-statistics.html"><a href="association-statistics.html#wrap-up-further-resources-7"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="part"><span><b>IV Reporting in R</b></span></li>
<li class="chapter" data-level="10" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>10</b> R Markdown</a>
<ul>
<li class="chapter" data-level="10.1" data-path="r-markdown.html"><a href="r-markdown.html#yaml-header-yet-another-markdown-language"><i class="fa fa-check"></i><b>10.1</b> YAML header (<em>Yet Another Markdown Language</em>)</a></li>
<li class="chapter" data-level="10.2" data-path="r-markdown.html"><a href="r-markdown.html#markdown-basics"><i class="fa fa-check"></i><b>10.2</b> Markdown Basics</a>
<ul>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#tables"><i class="fa fa-check"></i>Tables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="r-markdown.html"><a href="r-markdown.html#special-features"><i class="fa fa-check"></i><b>10.3</b> Special Features</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="r-markdown.html"><a href="r-markdown.html#section"><i class="fa fa-check"></i><b>10.3.1</b> </a></li>
<li class="chapter" data-level="10.3.2" data-path="r-markdown.html"><a href="r-markdown.html#html"><i class="fa fa-check"></i><b>10.3.2</b> HTML</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="r-markdown.html"><a href="r-markdown.html#including-r"><i class="fa fa-check"></i><b>10.4</b> Including R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="r-markdown.html"><a href="r-markdown.html#code-chunks"><i class="fa fa-check"></i><b>10.4.1</b> Code Chunks</a></li>
<li class="chapter" data-level="10.4.2" data-path="r-markdown.html"><a href="r-markdown.html#including-links-images"><i class="fa fa-check"></i><b>10.4.2</b> Including Links &amp; Images</a></li>
<li class="chapter" data-level="10.4.3" data-path="r-markdown.html"><a href="r-markdown.html#inline-code"><i class="fa fa-check"></i><b>10.4.3</b> Inline Code</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#wrap-up-further-resources-8"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="the-power-of-r-r-markdown.html"><a href="the-power-of-r-r-markdown.html"><i class="fa fa-check"></i><b>11</b> The Power of R &amp; R Markdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="the-power-of-r-r-markdown.html"><a href="the-power-of-r-r-markdown.html#the-papaja-package"><i class="fa fa-check"></i><b>11.1</b> The <code>papaja</code> Package</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="the-power-of-r-r-markdown.html"><a href="the-power-of-r-r-markdown.html#markdown-templates"><i class="fa fa-check"></i><b>11.1.1</b> Markdown Templates</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="the-power-of-r-r-markdown.html"><a href="the-power-of-r-r-markdown.html#taking-full-advantage-of-r"><i class="fa fa-check"></i><b>11.2</b> Taking full advantage of R</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="the-power-of-r-r-markdown.html"><a href="the-power-of-r-r-markdown.html#walkthrough"><i class="fa fa-check"></i><b>11.2.1</b> Walkthrough</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-power-of-r-r-markdown.html"><a href="the-power-of-r-r-markdown.html#exercise-8"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="the-power-of-r-r-markdown.html"><a href="the-power-of-r-r-markdown.html#wrap-up-further-resources-9"><i class="fa fa-check"></i>Wrap-Up &amp; Further Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="wrap-up.html"><a href="wrap-up.html"><i class="fa fa-check"></i>Wrap Up</a>
<ul>
<li class="chapter" data-level="" data-path="wrap-up.html"><a href="wrap-up.html#many-people-are-working-on-many-great-projects."><i class="fa fa-check"></i>Many people are working on many great projects.</a></li>
<li class="chapter" data-level="" data-path="wrap-up.html"><a href="wrap-up.html#r-can-be-hard."><i class="fa fa-check"></i>R can be hard.</a></li>
<li class="chapter" data-level="" data-path="wrap-up.html"><a href="wrap-up.html#but-its-worth-it."><i class="fa fa-check"></i>... but it's worth it.</a></li>
<li class="chapter" data-level="" data-path="wrap-up.html"><a href="wrap-up.html#r-is-really-fun"><i class="fa fa-check"></i>R is really fun!</a></li>
<li class="chapter" data-level="" data-path="wrap-up.html"><a href="wrap-up.html#outlook"><i class="fa fa-check"></i>Outlook</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="practice.html"><a href="practice.html"><i class="fa fa-check"></i>Practice</a>
<ul>
<li class="chapter" data-level="11.3" data-path="practice.html"><a href="practice.html#quiz-r"><i class="fa fa-check"></i><b>11.3</b> Quiz: R</a></li>
<li class="chapter" data-level="11.4" data-path="practice.html"><a href="practice.html#quiz-r-markdown"><i class="fa fa-check"></i><b>11.4</b> Quiz: R Markdown</a></li>
<li class="chapter" data-level="11.5" data-path="practice.html"><a href="practice.html#loops-write-a-for-loop-that-outputs-the-first-x-numbers-of-the-fibonacci-sequence-golden-ratio"><i class="fa fa-check"></i><b>11.5</b> Loops: Write a for-loop that outputs the first X numbers of the Fibonacci sequence ("golden ratio")</a></li>
<li class="chapter" data-level="11.6" data-path="practice.html"><a href="practice.html#rmarkdown-start-your-document-in-a-certain-way-that-matches-the-template"><i class="fa fa-check"></i><b>11.6</b> RMarkdown: Start your document in a certain way that matches the template!</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i>Toolbox</a>
<ul>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#shortcuts"><i class="fa fa-check"></i>Keyboard shortcuts to make your life easier</a></li>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#reading-in-data"><i class="fa fa-check"></i>Reading in Data</a></li>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#logic-1"><i class="fa fa-check"></i>Logic</a></li>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#mif"><i class="fa fa-check"></i>Most important <code>dplyr</code> functions</a></li>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#lop"><i class="fa fa-check"></i>Incomplete List of Useful Packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psychological Research with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="association-statistics" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Association Statistics<a href="association-statistics.html#association-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<script src="https://kit.fontawesome.com/0e67562c4f.js" crossorigin="anonymous"></script>
<!-- <link rel="stylesheet" href="./img/fontawesome.min.css"> -->
<p>In this chapter we will look into the correlation and linear regression model in R.</p>
<p>I will assume that you have a basic understanding of what all statistics mentioned in this book are, as they are commonly used among psychologists. However, let's start with a brief statistics re-cap to be on the same page. <i class="fa-solid fa-graduation-cap" style="color: darkred;"></i></p>
<p>Both the correlation - usually reported with Pearson's <em>r</em> coefficient - and the regression - also known as (general) linear model - give us measures of <strong>association</strong>.
The association can be positive (the larger x, the larger y) or negative (the larger x, the smaller y), which is reflected by the sign of the coefficient: <em>r = 1</em> would be a perfect positive correlation and <em>r = -1</em> would be a perfect negative correlation.</p>
<p>Hopefully, you have heard this one thousand times already, so let me tell you for the thousand and first time: <strong>Correlation does not imply causation</strong>.
The correlation coefficient r only tells us about the direction and strength of the association and nothing about the causal relation.
However, in the regression model we can check whether Y changes on the basis of X, so we can include assumptions of cause and effect in our model<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
<div class="figure"><span style="display:block;" id="fig:tree-age"></span>
<img src="_main_files/figure-html/tree-age-1.png" alt="Age and circumference of orange trees shown in a scatterplot. We can see that there seems to be a positive relationship between the two measures: The older the tree, the larger the circumference." width="672" />
<p class="caption">
Figure 9.1: Age and circumference of orange trees shown in a scatterplot. We can see that there seems to be a positive relationship between the two measures: The older the tree, the larger the circumference.
</p>
</div>
<!-- ### Pre-Requisites -->
<!-- <br> -->
<!-- - Load the seminar data using -->
<!--     - Please make sure you are using the R dataset from the <br> -->
<!--     zip folder in ILIAS, not the original csv file we first used! -->
<!-- ```{r} -->
<!-- seminar <- readRDS("./data/seminar_data.Rds") # the filepath might need adjustment for you -->
<!-- ``` -->
<!-- - Some of you were having trouble loading the data - please repeat the different types of data in R and the different commands used to load them! (from week 6) -->
<!-- - **Who is having trouble opening the slides as HTML?** -->
<div id="correlation" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Correlation<a href="association-statistics.html#correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The pearson correlation coefficient <em>r</em> measures <strong>association between two numeric variables</strong>.
The variables need to</p>
<ul>
<li>be <em>continuous</em> &amp; interval-scaled</li>
<li>be <em>normally distributed</em> &amp; should have <em>no outliers</em></li>
<li>have a <em>linear relationship</em>.</li>
</ul>
<p>Its range is from -1 to 1 which would mean a perfect negative or positive association, respectively.
The closer <em>r</em> is to 0, the weaker the correlation.</p>
<p>Since there will usually be some variation and noise in the data, I believe it makes sense to get a feeling for what different associations might look like.
So, you can play a game of "guess the correlation": Look at the four plots below and guess for each how strong the correlation could be be!
Remember - a <strong>positive</strong> correlation means "<strong>the more X, the more Y</strong>" and a <strong>negative</strong> correlation means "<strong>the more X, the less Y</strong>".</p>
<div id="guess-the-correlation" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Guess the correlation!<a href="association-statistics.html#guess-the-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="_main_files/figure-html/corr1-1.png" width="672" /></p>
<div class="webex-solution">
<button>
Solution
</button>
<p>r1 = 0.3, r2 = -0.2, r3 = 0.8, r4 = -0.75</p>
</div>
</div>
</div>
<div id="correlation-in-r" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Correlation in R<a href="association-statistics.html#correlation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Two main functions:
<ul>
<li><code>cor()</code> calculates the correlation</li>
<li><code>cor.test()</code> calculates correlation and significance</li>
</ul></li>
<li>As input they both need only an x and a y variable
<ul>
<li>You can specify some other aspects of the calculation, such as statistical method (e.g. "spearman") or how to deal with missing data</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="association-statistics.html#cb84-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> </span>
<span id="cb84-2"><a href="association-statistics.html#cb84-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="dv">10</span>)</span>
<span id="cb84-3"><a href="association-statistics.html#cb84-3" tabindex="-1"></a><span class="fu">cor</span>(x, y)</span>
<span id="cb84-4"><a href="association-statistics.html#cb84-4" tabindex="-1"></a><span class="co"># [1] -0.3333333</span></span>
<span id="cb84-5"><a href="association-statistics.html#cb84-5" tabindex="-1"></a><span class="fu">cor.test</span>(x, y)</span>
<span id="cb84-6"><a href="association-statistics.html#cb84-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb84-7"><a href="association-statistics.html#cb84-7" tabindex="-1"></a><span class="co">#   Pearson&#39;s product-moment correlation</span></span>
<span id="cb84-8"><a href="association-statistics.html#cb84-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb84-9"><a href="association-statistics.html#cb84-9" tabindex="-1"></a><span class="co"># data:  x and y</span></span>
<span id="cb84-10"><a href="association-statistics.html#cb84-10" tabindex="-1"></a><span class="co"># t = -1, df = 8, p-value = 0.3466</span></span>
<span id="cb84-11"><a href="association-statistics.html#cb84-11" tabindex="-1"></a><span class="co"># alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb84-12"><a href="association-statistics.html#cb84-12" tabindex="-1"></a><span class="co"># 95 percent confidence interval:</span></span>
<span id="cb84-13"><a href="association-statistics.html#cb84-13" tabindex="-1"></a><span class="co">#  -0.7959163  0.3749953</span></span>
<span id="cb84-14"><a href="association-statistics.html#cb84-14" tabindex="-1"></a><span class="co"># sample estimates:</span></span>
<span id="cb84-15"><a href="association-statistics.html#cb84-15" tabindex="-1"></a><span class="co">#        cor </span></span>
<span id="cb84-16"><a href="association-statistics.html#cb84-16" tabindex="-1"></a><span class="co"># -0.3333333</span></span></code></pre></div>
<div id="handling-missing-data" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Handling missing data<a href="association-statistics.html#handling-missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Many functions have an option for missing data or <code>NA</code>s
<ul>
<li>You can often add the argument <code>na.rm = TRUE</code> to a function for "NA remove"</li>
</ul></li>
<li>In the <code>cor()</code> function, we define to only use complete observations</li>
<li><div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="association-statistics.html#cb85-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb85-2"><a href="association-statistics.html#cb85-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="cn">NA</span>) <span class="co"># same length but 1 data point is missing</span></span>
<span id="cb85-3"><a href="association-statistics.html#cb85-3" tabindex="-1"></a><span class="fu">cor</span>(k, m)</span>
<span id="cb85-4"><a href="association-statistics.html#cb85-4" tabindex="-1"></a><span class="co"># [1] NA</span></span></code></pre></div></li>
<li>With <code>use = "complete.obs"</code> we define to only use pairs of observations that are not missing</li>
<li><div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="association-statistics.html#cb86-1" tabindex="-1"></a><span class="fu">cor</span>(k, m, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</span>
<span id="cb86-2"><a href="association-statistics.html#cb86-2" tabindex="-1"></a><span class="co"># [1] 0.8315218</span></span></code></pre></div></li>
<li><div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="association-statistics.html#cb87-1" tabindex="-1"></a><span class="fu">cor</span>(k[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], m[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb87-2"><a href="association-statistics.html#cb87-2" tabindex="-1"></a><span class="co"># [1] 0.8315218</span></span></code></pre></div></li>
</ul>
</div>
<div id="exercise-5" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Exercise<a href="association-statistics.html#exercise-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Is technology skill associated with seminar motivation? <i class="fa-solid fa-computer" style="color: #ff6600;"></i> <i class="fa-solid fa-child-reaching" style="color: #ff6600;"></i></p>
<p><br></p>
<p>Calculate a correlation test using <code>cor.test()</code> to analyze the question.</p>
<p>Try to formulate an interpretation as you would report it in a thesis or paper!</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="association-statistics.html#cb88-1" tabindex="-1"></a><span class="fu">cor.test</span>(seminar<span class="sc">$</span>v05_skill_tech, seminar<span class="sc">$</span>v10_motivation)</span>
<span id="cb88-2"><a href="association-statistics.html#cb88-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb88-3"><a href="association-statistics.html#cb88-3" tabindex="-1"></a><span class="co">#   Pearson&#39;s product-moment correlation</span></span>
<span id="cb88-4"><a href="association-statistics.html#cb88-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb88-5"><a href="association-statistics.html#cb88-5" tabindex="-1"></a><span class="co"># data:  seminar$v05_skill_tech and seminar$v10_motivation</span></span>
<span id="cb88-6"><a href="association-statistics.html#cb88-6" tabindex="-1"></a><span class="co"># t = 1.386, df = 11, p-value = 0.1932</span></span>
<span id="cb88-7"><a href="association-statistics.html#cb88-7" tabindex="-1"></a><span class="co"># alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb88-8"><a href="association-statistics.html#cb88-8" tabindex="-1"></a><span class="co"># 95 percent confidence interval:</span></span>
<span id="cb88-9"><a href="association-statistics.html#cb88-9" tabindex="-1"></a><span class="co">#  -0.2100186  0.7724602</span></span>
<span id="cb88-10"><a href="association-statistics.html#cb88-10" tabindex="-1"></a><span class="co"># sample estimates:</span></span>
<span id="cb88-11"><a href="association-statistics.html#cb88-11" tabindex="-1"></a><span class="co">#       cor </span></span>
<span id="cb88-12"><a href="association-statistics.html#cb88-12" tabindex="-1"></a><span class="co"># 0.3855856</span></span></code></pre></div>
<p>"With r = 0.386 there is a positive association of moderate strength between previous technological skill and motivation for the seminaR. This association is not significant (p = 0.193), likely due to the small sample size."</p>
</div>
</div>
<div id="quiz" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Quiz<a href="association-statistics.html#quiz" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Look at our seminar dataset by entering <code>str(seminar)</code> in the console.
Which of these correlations would work?
Choose "TRUE" if you think the correlation would work and "FALSE" if you think it would not.
You can look at the explanation for those that would not work below!</p>
<ol style="list-style-type: decimal">
<li><code>cor(seminar$v02_age, seminar$v04_bodyheight</code> <select class='webex-select'><option value='blank'></option><option value=''>TRUE</option><option value='answer'>FALSE</option></select></li>
<li><code>cor(seminar$v02_age, seminar$v08_loudness)</code> <select class='webex-select'><option value='blank'></option><option value='answer'>TRUE</option><option value=''>FALSE</option></select></li>
<li><code>cor(seminar$v08_loudness, seminar$v06_loc)</code><select class='webex-select'><option value='blank'></option><option value=''>TRUE</option><option value='answer'>FALSE</option></select></li>
</ol>
<div class="webex-solution">
<button>
Explanation
</button>
<ol style="list-style-type: decimal">
<li>There is a closing bracket missing</li>
<li>The variable <em>v06_loc</em> has numbers, but they are recognized as characters!</li>
</ol>
</div>
</div>
</div>
<div id="linear-regression" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Linear Regression<a href="association-statistics.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Linear regression also works on numerical, normally distributed data</li>
<li>We assume an association, and regression can help to look for causation
<ul>
<li>There is one <strong>dependent variable</strong> y and one <strong>independent variable</strong> x</li>
<li>In multiple linear regression, there can be several x</li>
</ul></li>
<li>Formula: <span class="math display">\[ y = \beta_0 + \beta x + \epsilon \]</span></li>
<li>What we are essentially doing is building a model for our data and checking how well it actually fits!</li>
</ul>
<div id="build-the-model" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Build the model<a href="association-statistics.html#build-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The R function for regression analysis is <code>lm()</code> for <em>linear model</em></li>
<li>It needs a "formula" as input - similar to the formula in the <code>t.test()</code>, we need the ~
<ul>
<li>Read Y ~ X as "Y on the basis of/ given X"</li>
<li>Our dependent variable Y goes first and our independent variable(s) go after the ~</li>
</ul></li>
<li>If the variables come from a data set, we need to specify data as well</li>
</ul>
</div>
<div id="visual-inspection" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Visual Inspection<a href="association-statistics.html#visual-inspection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="association-statistics.html#cb89-1" tabindex="-1"></a><span class="fu">ggplot</span>(Orange, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> circumference, <span class="at">color =</span> age)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb89-2"><a href="association-statistics.html#cb89-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">color=</span><span class="st">&quot;lightgray&quot;</span>, </span>
<span id="cb89-3"><a href="association-statistics.html#cb89-3" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">7</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb89-4"><a href="association-statistics.html#cb89-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb89-5"><a href="association-statistics.html#cb89-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Tree Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Trunk Circumference&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Do trees get thicker with age?&quot;</span>) <span class="sc">+</span> </span>
<span id="cb89-6"><a href="association-statistics.html#cb89-6" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb89-7"><a href="association-statistics.html#cb89-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:tree-age-elaborate"></span>
<img src="_main_files/figure-html/tree-age-elaborate-1.png" alt="Scatterplot of orange tree age and cirumference from before with the regression line added. Notice that the variable which is used as the independent X (age) is plotted on the X axis for intuitive reading of the plot." width="672" />
<p class="caption">
Figure 9.2: Scatterplot of orange tree age and cirumference from before with the regression line added. Notice that the variable which is used as the independent X (age) is plotted on the X axis for intuitive reading of the plot.
</p>
</div>
<p>What could be problematic here? <select class='webex-select'><option value='blank'></option><option value=''>homoscedasticity</option><option value=''>multicollinearity</option><option value='answer'>heteroscadasticity</option><option value=''>oranges</option></select></p>
</div>
<div id="build-the-model-1" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Build the model<a href="association-statistics.html#build-the-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="do-trees-get-thicker-with-age" class="section level4 hasAnchor" number="9.3.3.1">
<h4><span class="header-section-number">9.3.3.1</span> Do trees get thicker with age?<a href="association-statistics.html#do-trees-get-thicker-with-age" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="association-statistics.html#cb90-1" tabindex="-1"></a>Treelm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> circumference <span class="sc">~</span> age, <span class="at">data =</span> Orange)</span>
<span id="cb90-2"><a href="association-statistics.html#cb90-2" tabindex="-1"></a>Treelm</span>
<span id="cb90-3"><a href="association-statistics.html#cb90-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb90-4"><a href="association-statistics.html#cb90-4" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb90-5"><a href="association-statistics.html#cb90-5" tabindex="-1"></a><span class="co"># lm(formula = circumference ~ age, data = Orange)</span></span>
<span id="cb90-6"><a href="association-statistics.html#cb90-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb90-7"><a href="association-statistics.html#cb90-7" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb90-8"><a href="association-statistics.html#cb90-8" tabindex="-1"></a><span class="co"># (Intercept)          age  </span></span>
<span id="cb90-9"><a href="association-statistics.html#cb90-9" tabindex="-1"></a><span class="co">#     17.3997       0.1068</span></span></code></pre></div>
<ul>
<li>The lm alone gives us the mathematical formula</li>
<li>To look at the statistical results, we need to use another function such as <code>print()</code> or <code>summary()</code></li>
</ul>
</div>
</div>
<div id="analyze-the-model" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Analyze the model<a href="association-statistics.html#analyze-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="association-statistics.html#cb91-1" tabindex="-1"></a><span class="fu">summary</span>(Treelm)</span>
<span id="cb91-2"><a href="association-statistics.html#cb91-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-3"><a href="association-statistics.html#cb91-3" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb91-4"><a href="association-statistics.html#cb91-4" tabindex="-1"></a><span class="co"># lm(formula = circumference ~ age, data = Orange)</span></span>
<span id="cb91-5"><a href="association-statistics.html#cb91-5" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-6"><a href="association-statistics.html#cb91-6" tabindex="-1"></a><span class="co"># Residuals:</span></span>
<span id="cb91-7"><a href="association-statistics.html#cb91-7" tabindex="-1"></a><span class="co">#     Min      1Q  Median      3Q     Max </span></span>
<span id="cb91-8"><a href="association-statistics.html#cb91-8" tabindex="-1"></a><span class="co"># -46.310 -14.946  -0.076  19.697  45.111 </span></span>
<span id="cb91-9"><a href="association-statistics.html#cb91-9" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-10"><a href="association-statistics.html#cb91-10" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb91-11"><a href="association-statistics.html#cb91-11" tabindex="-1"></a><span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb91-12"><a href="association-statistics.html#cb91-12" tabindex="-1"></a><span class="co"># (Intercept) 17.399650   8.622660   2.018   0.0518 .  </span></span>
<span id="cb91-13"><a href="association-statistics.html#cb91-13" tabindex="-1"></a><span class="co"># age          0.106770   0.008277  12.900 1.93e-14 ***</span></span>
<span id="cb91-14"><a href="association-statistics.html#cb91-14" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb91-15"><a href="association-statistics.html#cb91-15" tabindex="-1"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb91-16"><a href="association-statistics.html#cb91-16" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-17"><a href="association-statistics.html#cb91-17" tabindex="-1"></a><span class="co"># Residual standard error: 23.74 on 33 degrees of freedom</span></span>
<span id="cb91-18"><a href="association-statistics.html#cb91-18" tabindex="-1"></a><span class="co"># Multiple R-squared:  0.8345,  Adjusted R-squared:  0.8295 </span></span>
<span id="cb91-19"><a href="association-statistics.html#cb91-19" tabindex="-1"></a><span class="co"># F-statistic: 166.4 on 1 and 33 DF,  p-value: 1.931e-14</span></span></code></pre></div>
<ul>
<li>Interpretation?
<ul>
<li>Trees get larger circumferences the older they are, but this might be modulated by their Species, environment or other factors</li>
</ul></li>
</ul>
</div>
<div id="exercise-6" class="section level3 hasAnchor" number="9.3.5">
<h3><span class="header-section-number">9.3.5</span> Exercise <i class="fa-regular fa-hourglass-half"  style="color: #dcdcdc;"></i> <i class="fa-solid fa-laptop-code"  style="color: #dcdcdc;"></i><a href="association-statistics.html#exercise-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><br></p>
<p>Does the age of a person have an influence on how long they took to complete the seminar survey (session length)?</p>
<p><br></p>
<p>Use the <code>lm()</code> function and report the significance level of the predictor as well as the model equation.</p>
<div class="webex-solution">
<button>
Solution (code)
</button>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="association-statistics.html#cb92-1" tabindex="-1"></a>age_sess <span class="ot">&lt;-</span> <span class="fu">lm</span>(session_length <span class="sc">~</span> v02_age, <span class="at">data =</span> seminar)</span>
<span id="cb92-2"><a href="association-statistics.html#cb92-2" tabindex="-1"></a><span class="fu">summary</span>(age_sess)</span>
<span id="cb92-3"><a href="association-statistics.html#cb92-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb92-4"><a href="association-statistics.html#cb92-4" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb92-5"><a href="association-statistics.html#cb92-5" tabindex="-1"></a><span class="co"># lm(formula = session_length ~ v02_age, data = seminar)</span></span>
<span id="cb92-6"><a href="association-statistics.html#cb92-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb92-7"><a href="association-statistics.html#cb92-7" tabindex="-1"></a><span class="co"># Residuals:</span></span>
<span id="cb92-8"><a href="association-statistics.html#cb92-8" tabindex="-1"></a><span class="co">#     Min      1Q  Median      3Q     Max </span></span>
<span id="cb92-9"><a href="association-statistics.html#cb92-9" tabindex="-1"></a><span class="co"># -34.978  -5.605   1.209  13.395  36.141 </span></span>
<span id="cb92-10"><a href="association-statistics.html#cb92-10" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb92-11"><a href="association-statistics.html#cb92-11" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb92-12"><a href="association-statistics.html#cb92-12" tabindex="-1"></a><span class="co">#             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb92-13"><a href="association-statistics.html#cb92-13" tabindex="-1"></a><span class="co"># (Intercept)  182.706     61.517   2.970   0.0127 *</span></span>
<span id="cb92-14"><a href="association-statistics.html#cb92-14" tabindex="-1"></a><span class="co"># v02_age       -4.186      2.689  -1.557   0.1478  </span></span>
<span id="cb92-15"><a href="association-statistics.html#cb92-15" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb92-16"><a href="association-statistics.html#cb92-16" tabindex="-1"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb92-17"><a href="association-statistics.html#cb92-17" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb92-18"><a href="association-statistics.html#cb92-18" tabindex="-1"></a><span class="co"># Residual standard error: 21.23 on 11 degrees of freedom</span></span>
<span id="cb92-19"><a href="association-statistics.html#cb92-19" tabindex="-1"></a><span class="co"># Multiple R-squared:  0.1805,  Adjusted R-squared:  0.106 </span></span>
<span id="cb92-20"><a href="association-statistics.html#cb92-20" tabindex="-1"></a><span class="co"># F-statistic: 2.423 on 1 and 11 DF,  p-value: 0.1478</span></span></code></pre></div>
</div>
<p><br></p>
<div class="webex-solution">
<button>
Solution (interpretation)
</button>
<p>"The age of a person does not significantly predict the time it took them to complete the survey (p = .148). The model equation is 182.7 -4.19X with age explaining about 18% of the variance in session length for the survey."</p>
<p><img src="_main_files/figure-html/age-sess-1.png" width="672" /></p>
</div>
</div>
<div id="a-word-to-the-wise" class="section level3 hasAnchor" number="9.3.6">
<h3><span class="header-section-number">9.3.6</span> A word to the wise<a href="association-statistics.html#a-word-to-the-wise" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>There is also a function called <code>glm()</code> for general linear model</li>
<li>In the cases I showed you, both perform the same tasks</li>
<li>The <code>glm()</code> can also handle other more advanced statistical analyses, including logistic regression</li>
<li>However, the <code>lm()</code> function will output the coefficient of determination <span class="math inline">\(R^2\)</span>
<ul>
<li>It tell us the proportion of the variation in the dependent variable that is predictable from the independent variable(s)</li>
<li>We <em>could</em> also calculate it by hand using the <code>cor()</code> function and squaring the result</li>
</ul></li>
</ul>
</div>
</div>
<div id="anova-exercise" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> ANOVA Exercise<a href="association-statistics.html#anova-exercise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Reminder: There are generally 3 steps to an ANOVA</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="association-statistics.html#cb93-1" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(v08_loudness <span class="sc">~</span> v11_soul, <span class="at">data =</span> seminar) <span class="co"># 1.</span></span>
<span id="cb93-2"><a href="association-statistics.html#cb93-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(v08_loudness <span class="sc">~</span> v11_soul, <span class="at">data =</span> seminar) <span class="co"># 2.</span></span>
<span id="cb93-3"><a href="association-statistics.html#cb93-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb93-4"><a href="association-statistics.html#cb93-4" tabindex="-1"></a><span class="fu">TukeyHSD</span>(model) <span class="co"># 3.</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Check assumptions with Levene Test</li>
<li>Build the model to perform an omnibus ANOVA</li>
<li>Perform post-hoc tests to check pairwise differences (usually only if the omnibus ANOVA is significant)</li>
</ol>
<div id="exercise-7" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Exercise<a href="association-statistics.html#exercise-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Does the preferred music volume depend on someone's soul philosophy?</strong> <i class="fa-solid fa-music"></i><i class="fa-solid fa-ghost" style="color: #dcdcdc;"></i></p>
<p><br></p>
<p>Perform an ANOVA on our seminar data to explore the question (v08 &amp; v12).</p>
<div class="webex-solution">
<button>
Solution omnibus ANOVA
</button>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="association-statistics.html#cb94-1" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(v08_loudness <span class="sc">~</span> v12_soul_phil, <span class="at">data =</span> seminar)</span>
<span id="cb94-2"><a href="association-statistics.html#cb94-2" tabindex="-1"></a><span class="co"># Warning in leveneTest.default(y = y, group = group, ...): group coerced to</span></span>
<span id="cb94-3"><a href="association-statistics.html#cb94-3" tabindex="-1"></a><span class="co"># factor.</span></span>
<span id="cb94-4"><a href="association-statistics.html#cb94-4" tabindex="-1"></a><span class="co"># Levene&#39;s Test for Homogeneity of Variance (center = median)</span></span>
<span id="cb94-5"><a href="association-statistics.html#cb94-5" tabindex="-1"></a><span class="co">#       Df F value Pr(&gt;F)</span></span>
<span id="cb94-6"><a href="association-statistics.html#cb94-6" tabindex="-1"></a><span class="co"># group  2  0.3112 0.7394</span></span>
<span id="cb94-7"><a href="association-statistics.html#cb94-7" tabindex="-1"></a><span class="co">#       10</span></span>
<span id="cb94-8"><a href="association-statistics.html#cb94-8" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(v08_loudness <span class="sc">~</span> v12_soul_phil, <span class="at">data =</span> seminar)</span>
<span id="cb94-9"><a href="association-statistics.html#cb94-9" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb94-10"><a href="association-statistics.html#cb94-10" tabindex="-1"></a><span class="co">#               Df Sum Sq Mean Sq F value  Pr(&gt;F)   </span></span>
<span id="cb94-11"><a href="association-statistics.html#cb94-11" tabindex="-1"></a><span class="co"># v12_soul_phil  2 1164.8   582.4   8.797 0.00625 **</span></span>
<span id="cb94-12"><a href="association-statistics.html#cb94-12" tabindex="-1"></a><span class="co"># Residuals     10  662.1    66.2                   </span></span>
<span id="cb94-13"><a href="association-statistics.html#cb94-13" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb94-14"><a href="association-statistics.html#cb94-14" tabindex="-1"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<p><br></p>
<p>Look for pairwise differences even if the overall ANOVA does not reach significance.</p>
<div class="webex-solution">
<button>
Solution pairwise comparison
</button>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="association-statistics.html#cb95-1" tabindex="-1"></a><span class="fu">TukeyHSD</span>(model)</span>
<span id="cb95-2"><a href="association-statistics.html#cb95-2" tabindex="-1"></a><span class="co">#   Tukey multiple comparisons of means</span></span>
<span id="cb95-3"><a href="association-statistics.html#cb95-3" tabindex="-1"></a><span class="co">#     95% family-wise confidence level</span></span>
<span id="cb95-4"><a href="association-statistics.html#cb95-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-5"><a href="association-statistics.html#cb95-5" tabindex="-1"></a><span class="co"># Fit: aov(formula = v08_loudness ~ v12_soul_phil, data = seminar)</span></span>
<span id="cb95-6"><a href="association-statistics.html#cb95-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-7"><a href="association-statistics.html#cb95-7" tabindex="-1"></a><span class="co"># $v12_soul_phil</span></span>
<span id="cb95-8"><a href="association-statistics.html#cb95-8" tabindex="-1"></a><span class="co">#                      diff        lwr       upr     p adj</span></span>
<span id="cb95-9"><a href="association-statistics.html#cb95-9" tabindex="-1"></a><span class="co"># dunno-dualism    9.714286  -5.678116 25.106687 0.2419042</span></span>
<span id="cb95-10"><a href="association-statistics.html#cb95-10" tabindex="-1"></a><span class="co"># monism-dualism -13.666667 -31.879202  4.545868 0.1490289</span></span>
<span id="cb95-11"><a href="association-statistics.html#cb95-11" tabindex="-1"></a><span class="co"># monism-dunno   -23.380952 -38.773354 -7.988551 0.0049965</span></span></code></pre></div>
</div>
<p><br></p>
<p>Choose and create an appropriate visualization for this data!</p>
<div class="webex-solution">
<button>
Solution Data Viz
</button>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="association-statistics.html#cb96-1" tabindex="-1"></a><span class="fu">ggplot</span>(seminar, <span class="fu">aes</span>(<span class="at">x =</span> v12_soul_phil, <span class="at">y =</span> v08_loudness, </span>
<span id="cb96-2"><a href="association-statistics.html#cb96-2" tabindex="-1"></a>                    <span class="at">color =</span> v12_soul_phil, <span class="at">fill =</span> v12_soul_phil)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="association-statistics.html#cb96-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb96-4"><a href="association-statistics.html#cb96-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb96-5"><a href="association-statistics.html#cb96-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-6"><a href="association-statistics.html#cb96-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Soul Philosophy&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Preferred Volume (arbitrary units)&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-7"><a href="association-statistics.html#cb96-7" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
</div>
<!-- ```{r} -->
<!-- model <- data.frame(age = Orange$age, -->
<!--                     circ = (17.3997 + Orange$age * 0.107)) -->
<!-- ggplot(model, aes(x = age, y = circ, color = age)) + -->
<!--   geom_jitter(size = 3) + -->
<!--   geom_smooth(method = "lm", se=FALSE, color="lightgray", linewidth = .7, formula = y ~ x) + -->
<!--   theme_minimal() +  -->
<!--   labs(x = "Tree Age", y = "Trunk Circumference") + -->
<!--   scale_color_distiller(palette = 7) + theme(legend.position = "none") -->
<!-- ``` -->
</div>
</div>
<div id="wrap-up-further-resources-7" class="section level2 unnumbered hasAnchor">
<h2>Wrap-Up &amp; Further Resources<a href="association-statistics.html#wrap-up-further-resources-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<i class="fa-solid fa-anchor" style="color: teal;"></i>
<ul style="color: teal;">
<li>
Correlation coefficient <em>r</em> can be determined using <code>cor(x,y)</code>
</li>
<li>
<span class="math inline">\(R^2\)</span> is the coefficient of determination in a linear model (calculate by hand or in the model formula)
</li>
<li>
The linear model function <code>lm()</code> is used to build models for linear regression
</li>
<li>
Problems such as overfitting or heteroscedasticity reduce the interpretability of the model results
</li>
</ul>
<p><br></p>
<i class="fa-solid fa-book" style="color: orange;"></i>
<ul style="color: orange;">
<li>
<a href="https://www.guessthecorrelation.com/" target="_blank">Guess the Correlation</a>
</li>
<li>
<a href="https://statisticsbyjim.com/basics/correlation-coefficient-formula/" target="_blank">Explanation: Correlation</a>
</li>
<li>
<a href="https://www.datacamp.com/tutorial/linear-regression-R" target="_blank">Linear Regression in R</a>
</li>
<li>
<a href="https://www.codecademy.com/learn/learn-linear-regression-in-r/modules/linear-regression-in-r/cheatsheet/" target="_blank">lm() cheatsheet</a>
</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="association-statistics.html#cb97-1" tabindex="-1"></a><span class="fu">ggplot</span>(Orange, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> circumference, <span class="at">color =</span> Tree)) <span class="sc">+</span></span>
<span id="cb97-2"><a href="association-statistics.html#cb97-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Tree Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Trunk Circumference&quot;</span>) <span class="sc">+</span></span>
<span id="cb97-3"><a href="association-statistics.html#cb97-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Tree)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/orange-pretty-1.png" width="672" /></p>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>A linear model that is ill-defined might still become significant and thus misleading, so your modeling decisions should always be made with a theoretical basis.<a href="association-statistics.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="difference-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-markdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/the-tave/psych_research_with_r/issues/09_Statistics_cor-glm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
